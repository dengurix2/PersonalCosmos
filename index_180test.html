<!DOCTYPE html><html lang="en">	<head>		<title>Personal Cosmos</title>		<meta charset="utf-8">		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">		<style>			body {				font-family: Monospace;				background-color: #000;				margin: 0px;				overflow: hidden;			}		</style>	</head>	<body>		<script src="js/three.min.r58.js"></script>		<script src="js/Detector.js"></script>		<script src="js/PersonalCosmos.js"></script>		<script src="js/TrackballControls.js"></script>		<script>			if ( ! Detector.webgl ) Detector.addGetWebGLMessage();			var container;			var camera, controls, scene, renderer;			var object;			init();			animate();			function init() {				container = document.createElement( 'div' );				document.body.appendChild( container );				camera = new THREE.PerspectiveCamera( 175, window.innerWidth / window.innerHeight, 0.1, 2000 );				camera.position.z = 100;											controls = new THREE.TrackballControls( camera );				controls.rotateSpeed = 0.1;				controls.zoomSpeed = 0.1;				controls.panSpeed = 0.1;									scene = new THREE.Scene();				var light, materials;				scene.add( new THREE.AmbientLight( 0xffffff ) );				light = new THREE.DirectionalLight( 0xffffff );				light.position.set( 0, 0, 1 );				scene.add( light );				var map = THREE.ImageUtils.loadTexture( 'image/earth_atmos_2048.jpg' );//ノーマル地球//				var map = THREE.ImageUtils.loadTexture( 'image/ash_uvgrid01.jpg' );//キャリブレーション//				var map = THREE.ImageUtils.loadTexture( 'image/0000.jpg' );//				var map = THREE.ImageUtils.loadTexture( 'image/c720x540.jpg' );//火星の画像//				var map = THREE.ImageUtils.loadTexture( 'image/moon_1024.jpg' );//月の画像				map.wrapS = map.wrapT = THREE.RepeatWrapping;				map.anisotropy = 16;				materials = [					new THREE.MeshLambertMaterial( { ambient: 0xbbbbbb, map: map, side: THREE.DoubleSide } ),					new THREE.MeshBasicMaterial( { color: 0xffffff, wireframe: false, transparent: true, opacity: 0.1, side: THREE.DoubleSide } )				];				var points = [];				for ( var i = 0; i < 10; i ++ ) {					points.push( new THREE.Vector3( 0, i, 0 ) );				}				//object = THREE.SceneUtils.createMultiMaterialObject( new PersonalCosmos( points, 100 ), materials );				//scene.add( object );				object = new THREE.AxisHelper( 500 );				scene.add( object );								object = THREE.SceneUtils.createMultiMaterialObject( new THREE.SphereGeometry( 100, 64, 64 ), materials );				//object.position.set( -400, 0, 200 );				object.rotation.x = -3.14*0.5;				scene.add( object );												renderer = new THREE.WebGLRenderer( { antialias: false } );				renderer.setSize( window.innerWidth, window.innerHeight );				container.appendChild( renderer.domElement );				window.addEventListener( 'resize', onWindowResize, false );				window.addEventListener('dragover', function(event) {
					event.preventDefault();				}, false);				window.addEventListener( 'drop', function(event) {					onFileDrop(event);				}, false );			}			function onWindowResize() {				camera.aspect = window.innerWidth / window.innerHeight;				camera.updateProjectionMatrix();				renderer.setSize( window.innerWidth, window.innerHeight );			}			//			function animate() {				requestAnimationFrame( animate );				render();			}			function render() {				var timer = Date.now() * 0.0001;				camera.lookAt( scene.position );				for ( var i = 0, l = scene.children.length; i < l; i ++ ) {					var obj = scene.children[ i ];					//obj.rotation.z = -timer * 1.0;				}				controls.update();				renderer.render( scene, camera );			}			function onFileDrop(event){				var image = new Image();				var file = event.dataTransfer.files[0]				var reader = new FileReader();
					reader.onload = function(e) {
					image.src = reader.result;				};
				reader.readAsDataURL(file);				image.onload = function() {					var canvas = document.createElement("canvas");					canvas.width=image.width;
					canvas.height=image.height;
					var ctx = canvas.getContext("2d");
					ctx.drawImage(image,0,0,image.width,image.height,0,0,image.width,image.height);
				    var map = new THREE.Texture( canvas, new THREE.UVMapping(), THREE.ClampToEdgeWrapping, THREE.ClampToEdgeWrapping, THREE.NearestFilter,THREE.NearestMipMapLinearFilter);
					map.needsUpdate = true;					map.wrapS = map.wrapT = THREE.RepeatWrapping;					map.anisotropy = 16;					materials = [						new THREE.MeshLambertMaterial( { ambient: 0xbbbbbb, map: map, side: THREE.DoubleSide } ),						new THREE.MeshBasicMaterial( { color: 0xffffff, wireframe: false, transparent: true, opacity: 0.001, side: THREE.DoubleSide } )					];					var points = [];					for ( var i = 0; i < 10; i ++ ) {						points.push( new THREE.Vector3( 0, i, 0 ) );					}					scene.remove(object);					object = THREE.SceneUtils.createMultiMaterialObject( new PersonalCosmos( points, 100 ), materials );					scene.add(object );				}				event.preventDefault();
								event.stopPropagation();			}		</script>	</body></html>